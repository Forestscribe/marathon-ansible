# This file defines all kind of global parameters and defaults
---

 # hostsPorts is used to put one service into every agent. It uses host port reservation to ensure this
hostPorts:

    nginx_http:       80
    nginx_ssl:        443

    collectd:         20010
    marathon_lb:      20011

# service ports are defined globally, and used for service discovery
servicePorts:
    influxdb:         30010
    graphite:         30011
    influxdb_admin:   30012

    grafana:          30020

    elasticsearch:     30025
    logstashapi:      30026
    kibana:            30027
    syslog:            30028
    logstash:          30029

    buildbot_www:     30030
    buildbot_worker:  30031
    buildbot_hooks:   30032

    postgres:         30040

    crossbar:         30050

    ngrok:            30060

    artifactory:      28081

    zk_http:          30080

    sota_maria:           30100
    sota_nats:            30101
    sota_device_registry: 30102
    sota_resolver:        30103
    sota_core:            30104
    sota_ldap:            30105
    sota_webserver:       30106


zk_host: "{{ ansible_env.ZK_HOST }}"
zookeeper_uri: "zk://{{ zookeeper_host }}"
zookeeper_etc_uri: "{{ zookeeper_uri }}/etc"

docker_ip: "{{  zk.cloud.docker_interface_ip }}"
marathon_num_agents: 5 # "{{ zk.cloud.mesos_num_agents}}"

# config files can be downloaded via marathon_uri using this service (see influxdb for an example)
zk_http_url: "http://{{ docker_ip }}:{{ servicePorts.zk_http }}"

marathon_uri: "{{ zk.cloud.marathon_uri }}"
nginx_external_url: "{{ zk.cloud.nginx_external_url }}"
github_status_token:  "{{ zk.secrets.github_status_token }}"

# PG config for buildbot
POSTGRES_USER: "{{ zk.secrets.postgres_user }}"
POSTGRES_PASSWORD: "{{ zk.secrets.postgres_passwd }}"
POSTGRES_DB: "{{ zk.secrets.postgres_db }}"

proxy_env: "{{ zk.proxy_env }}"

basic_http_health_check:
    path: /
    protocol: HTTP
    portIndex: 0
    gracePeriodSeconds: 300
    intervalSeconds: 60
    timeoutSeconds: 20
    maxConsecutiveFailures: 3
    ignoreHttp1xx: false

basic_tcp_health_check:
    protocol: TCP
    portIndex: 0
    gracePeriodSeconds: 300
    intervalSeconds: 60
    timeoutSeconds: 20
    maxConsecutiveFailures: 3
